Sub mergeFiles()
    ' Merges all data into a single sheet in the main file.
    
    ' Define variables
    Dim numberOfFilesChosen As Integer
    Dim tempFileDialog As FileDialog
    Dim mainWorkbook As Workbook
    Dim sourceWorkbook As Workbook
    Dim mainSheet As Worksheet
    Dim sourceSheet As Worksheet
    Dim lastRow As Long
    Dim pasteRow As Long
    
    ' Set main workbook and create a new sheet for merged data
    Set mainWorkbook = Application.ActiveWorkbook
    Set mainSheet = mainWorkbook.Sheets(1) ' Assuming data is merged in the first sheet
    
    ' Initialize file picker dialog
    Set tempFileDialog = Application.FileDialog(msoFileDialogFilePicker)
    tempFileDialog.AllowMultiSelect = True ' Allow multiple workbook selection
    numberOfFilesChosen = tempFileDialog.Show
    
    ' Loop through all selected workbooks
    For i = 1 To tempFileDialog.SelectedItems.Count
        ' Open each workbook
        Set sourceWorkbook = Workbooks.Open(tempFileDialog.SelectedItems(i))
        
        ' Loop through each sheet in the source workbook
        For Each sourceSheet In sourceWorkbook.Sheets
            ' Find last used row in mainSheet
            lastRow = mainSheet.Cells(mainSheet.Rows.Count, 1).End(xlUp).Row
            pasteRow = lastRow + 1 ' Next available row
            
            ' Find last used row in sourceSheet
            Dim sourceLastRow As Long
            sourceLastRow = sourceSheet.Cells(sourceSheet.Rows.Count, 1).End(xlUp).Row
            
            ' Copy used range from source sheet (excluding headers if necessary)
            sourceSheet.Range("A1:X" & sourceLastRow).Copy ' Adjust column range if needed
            mainSheet.Cells(pasteRow, 1).PasteSpecial Paste:=xlPasteValues
            
        Next sourceSheet
        
        ' Close the source workbook without saving
        sourceWorkbook.Close False
    Next i
    
    ' Clean up
    Application.CutCopyMode = False
    
    MsgBox "Merge Complete!", vbInformation
End Sub